<mat-toolbar><span>Плановые отключения</span>
  <span class="fill-remaining-space"></span>
  <!--<a mat-button color="primary" routerLink="view-audit-section" matTooltip="Просмотреть запросы">Аудит запросов</a>
  <button mat-button color="secondary" (click)="goBack()">Назад</button>-->
</mat-toolbar>
<mat-spinner *ngIf="isLoadingResults"></mat-spinner>
<div class="responsive">
  <table matTableExporter #exporter="matTableExporter" mat-table [dataSource]="ordersData" class="example-table"
    matSort>
    <!-- Created Column -->
    <ng-container matColumnDef="vid">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>
        Вид отключения
      </th>
      <td mat-cell *matCellDef="let row">{{row.vid}}</td>
    </ng-container>

    <!-- name Column -->
    <ng-container matColumnDef="name_tp">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Название ТП</th>
      <td mat-cell *matCellDef="let row">{{row.name_tp}}</td>
    </ng-container>

    <!-- legalAddress Column -->
    <ng-container matColumnDef="data_otkl">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Дата/время откл.</th>
      <td mat-cell *matCellDef="let row">{{row.data_otkl | date:'dd.MM.yyyy hh:mm'}}</td>
    </ng-container>

    <!-- legalAddress Column -->
    <ng-container matColumnDef="nazvanie_zavis">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Причина</th>
      <td mat-cell *matCellDef="let row">{{row.nazvanie_zavis}}</td>
    </ng-container>

    <!-- Column -->
    <ng-container matColumnDef="data_vkl">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Дата/время вкл.</th>
      <td mat-cell *matCellDef="let row">{{row.data_vkl | date:'dd.MM.yyyy hh:mm'}}</td>
    </ng-container>

    <!-- Column -->
    <ng-container matColumnDef="fioUser">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Ф.И.О.(вводившего)</th>
      <td mat-cell *matCellDef="let row">{{row.fioUser}}</td>
    </ng-container>

    <!-- inn Column -->
    <ng-container matColumnDef="nazvanie_slujby">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>РЭС</th>
      <td mat-cell *matCellDef="let row">{{row.nazvanie_slujby}}</td>
    </ng-container>

    <!-- inn Column -->
    <ng-container matColumnDef="nazvanie_podstansii">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Подстанция</th>
      <td mat-cell *matCellDef="let row">{{row.nazvanie_podstansii}}</td>
    </ng-container>

    <!-- inn Column -->
    <ng-container matColumnDef="nazv_fidera">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Фидер</th>
      <td mat-cell *matCellDef="let row">{{row.nazv_fidera}}</td>
    </ng-container>

    <!-- Header row first group -->
    <ng-container matColumnDef="header-row-first-group">
      <th mat-header-cell *matHeaderCellDef [attr.colspan]="8">
        Плановые отключения по ВЛ 6-10 кВ
      </th>
    </ng-container>
    <!-- Header row second group -->
    <ng-container matColumnDef="header-row-second-group">
      <th mat-header-cell *matHeaderCellDef [attr.colspan]="1">
        <button color="primary" matTooltip="Скачать в Excel" mat-button
          (click)="exporter.exportTable('xlsx', {fileName:'export-file', sheet: 'sheet_name', Props: {Author: 'Talha'}})">
          <mat-icon>get_app</mat-icon> скачать Excel
        </button>
      </th>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="['header-row-first-group','header-row-second-group']"></tr>
    <tr mat-header-row *matHeaderRowDef="suppliersDisplayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: suppliersDisplayedColumns;">
    </tr>
  </table>
</div>

<mat-paginator [pageSizeOptions]="[5, 10, 25, 100]" [pageSize]="10" showFirstLastButtons></mat-paginator>

<app-planned-offs-ext></app-planned-offs-ext>
